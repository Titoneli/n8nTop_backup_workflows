{"createdAt":"2025-11-20T13:00:06.685Z","updatedAt":"2025-11-20T13:28:10.908Z","id":"22LziuCuesg5d5uP","name":"WH_TOP_BOLETOS_PERIODO","active":true,"isArchived":false,"nodes":[{"parameters":{"path":"atualizar_boletos_periodo","responseMode":"responseNode","options":{}},"type":"n8n-nodes-base.webhook","typeVersion":2.1,"position":[-880,16],"id":"5085cecf-d5cd-44a6-b9da-d0e55c94d0f5","name":"Webhook","webhookId":"d1728fc6-0fef-4add-976e-048e4111d380","executeOnce":true},{"parameters":{"workflowId":{"__rl":true,"value":"Rnq3NIE0dV7902vT","mode":"list","cachedResultUrl":"/workflow/Rnq3NIE0dV7902vT","cachedResultName":"SUB_POPULA_TOP_BOLETOS_MENSAL"},"workflowInputs":{"mappingMode":"defineBelow","value":{"quantidadePagina":"={{ $('dadosDatas').item.json.quantidadePagina }}","dtVencimentoInicial":"={{ $('dadosDatas').item.json.dtVencimentoInicial }}","dtVencimentoFinal":"={{ $('dadosDatas').item.json.dtVencimentoFinal }}"},"matchingColumns":[],"schema":[{"id":"dtVencimentoInicial","displayName":"dtVencimentoInicial","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false},{"id":"dtVencimentoFinal","displayName":"dtVencimentoFinal","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"string","removed":false},{"id":"quantidadePagina","displayName":"quantidadePagina","required":false,"defaultMatch":false,"display":true,"canBeUsedToMatch":true,"type":"number","removed":false}],"attemptToConvertTypes":false,"convertFieldsToString":true},"mode":"each","options":{"waitForSubWorkflow":true}},"type":"n8n-nodes-base.executeWorkflow","typeVersion":1.3,"position":[-208,16],"id":"988aef4f-e846-41dc-89a7-27e2848b382b","name":"Call 'SUB_POPULA_TOP_BOLETOS_MENSAL'1"},{"parameters":{"assignments":{"assignments":[{"id":"a5ba2546-bb0c-4057-ae8e-27c8d8df705e","name":"dtVencimentoInicial","value":"={{ $('Webhook').item.json.query.di }}","type":"string"},{"id":"b22f66c6-314b-43d6-a3de-3cd8d2aef75a","name":"dtVencimentoFinal","value":"={{ $('Webhook').item.json.query.df }}","type":"string"},{"id":"490f9986-3862-491f-9976-320cd03a025e","name":"quantidadePagina","value":"={{ $('Webhook').item.json.query.quantidadePagina ?? 500 }}","type":"number"}]},"options":{}},"type":"n8n-nodes-base.set","typeVersion":3.4,"position":[-432,16],"id":"87103c42-57bc-4f24-82ed-f3146e5a89d9","name":"dadosDatas","notes":"{{ \n  (() => {\n    const now = new Date();\n    const firstDay = new Date(now.getFullYear(), now.getMonth(), 1);\n    const dd = String(firstDay.getDate()).padStart(2, '0');\n    const mm = String(firstDay.getMonth() + 1).padStart(2, '0');\n    const yyyy = firstDay.getFullYear();\n    return `${dd}/${mm}/${yyyy}`;\n  })()\n}}\n\n{{ \n  (() => {\n    const now = new Date();\n    const lastDay = new Date(now.getFullYear(), now.getMonth() + 1, 0);\n    const dd = String(lastDay.getDate()).padStart(2, '0');\n    const mm = String(lastDay.getMonth() + 1).padStart(2, '0');\n    const yyyy = lastDay.getFullYear();\n    return `${dd}/${mm}/${yyyy}`;\n  })()\n}}\n\n"},{"parameters":{"conditions":{"options":{"caseSensitive":true,"leftValue":"","typeValidation":"strict","version":2},"conditions":[{"id":"86099175-9124-4ff8-b539-d5dc87e37715","leftValue":"={{ $('Webhook').item.json.query.di }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}},{"id":"d85554ce-62f0-4592-b0f2-47e8aea9bd09","leftValue":"={{ $('Webhook').item.json.query.df }}","rightValue":"","operator":{"type":"string","operation":"notEmpty","singleValue":true}}],"combinator":"and"},"options":{}},"type":"n8n-nodes-base.if","typeVersion":2.2,"position":[-656,16],"id":"4e8da811-1168-4a9a-9afc-65601539c2a3","name":"If"},{"parameters":{"respondWith":"text","responseBody":"={{ \n'Informe o período para atualização :: ' + '\\n\\n' +\n'\\nData inicial ' + $('Webhook').item.json.query.di  + ' :: ' +\n'\\nData final ' + $('Webhook').item.json.query.df  + '\\n'\n}}","options":{"responseCode":400}},"type":"n8n-nodes-base.respondToWebhook","typeVersion":1.4,"position":[-432,208],"id":"11915c51-3d03-43e4-9165-98bf443b3e93","name":"Respond to Webhook"},{"parameters":{"respondWith":"text","responseBody":"={{ 'Atualização iniciada para o periodo de ' + $('Webhook').item.json.query.di + ' a ' + $('Webhook').item.json.query.df }}","options":{"responseCode":400}},"type":"n8n-nodes-base.respondToWebhook","typeVersion":1.4,"position":[-432,-176],"id":"1230cacb-28eb-430c-9853-86291530e4de","name":"Respond to Webhook1"}],"connections":{"Webhook":{"main":[[{"node":"If","type":"main","index":0}]]},"Call 'SUB_POPULA_TOP_BOLETOS_MENSAL'1":{"main":[[]]},"dadosDatas":{"main":[[{"node":"Call 'SUB_POPULA_TOP_BOLETOS_MENSAL'1","type":"main","index":0}]]},"If":{"main":[[{"node":"Respond to Webhook1","type":"main","index":0},{"node":"dadosDatas","type":"main","index":0}],[{"node":"Respond to Webhook","type":"main","index":0}]]}},"settings":{"executionOrder":"v1","saveDataErrorExecution":"all","saveDataSuccessExecution":"all","saveExecutionProgress":true,"saveManualExecutions":true,"callerPolicy":"workflowsFromSameOwner","errorWorkflow":"TfwD6eX8vHLcjYJt"},"staticData":{"node:Schedule Trigger":{"recurrenceRules":[]},"node:Schedule Trigger1":{"recurrenceRules":[]}},"meta":{"templateCredsSetupCompleted":true},"pinData":{},"versionId":"63cb3018-334d-4a77-9fc8-e589666f0ce4","triggerCount":1,"shared":[{"createdAt":"2025-11-20T13:00:06.685Z","updatedAt":"2025-11-20T13:00:06.685Z","role":"workflow:owner","workflowId":"22LziuCuesg5d5uP","projectId":"Q1ZOyZgW3upjWPqV"}],"tags":[{"createdAt":"2025-09-24T20:09:10.216Z","updatedAt":"2025-09-24T20:09:10.216Z","id":"unxeE4bOTKE0sCc3","name":"BI"},{"createdAt":"2025-10-31T20:57:24.413Z","updatedAt":"2025-10-31T20:57:24.413Z","id":"XBzzNcD65NDClpM2","name":"20:00"}]}